# Build script for libxcrypt.
# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025, John Unland

version=4.4.36

cd -- "$TMPDIR"

rm -rf libxcrypt-${version}

unpack "${worktree}/sources/libxcrypt-${version}.tar.xz"

cd libxcrypt-${version}

./configure \
    --prefix=/usr \
    --enable-hashes=strong,glibc \
    --enable-obsolete-api=no \
    --disable-static \
    --disable-failure-tokens

make -j${jobs}

make check -j${jobs}

make install -j${jobs}

if [ "$CLEANUP" == true ]; then
    cd -- "$TMPDIR" && rm -rf libxcrypt-${version}
fi
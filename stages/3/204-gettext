# Build script for gettext.
# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025, John Unland

version=0.22.5

cd -- "$TMPDIR"

rm -rf gettext-$version

unpack "${worktree}/sources/gettext-$version.tar.xz"

cd gettext-$version

./configure \
    --prefix=/usr \
    --disable-static \
    --docdir=/usr/share/doc/gettext-$version

make -j${jobs}

make check -j${jobs}

make install -j${jobs}

chmod -v 0755 /usr/lib/preloadable_libintl.so

if [ "$CLEANUP" == true ]; then
    cd -- "$TMPDIR" && rm -rf gettext-$version
fi

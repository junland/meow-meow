# Build script for gawk.
# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025, John Unland

version=5.3.0

cd -- "$TMPDIR"

rm -rf gawk-$version
unpack "${worktree}/sources/gawk-$version.tar.xz"

cd gawk-$version

# Ensure not to build unnecessary files
sed -i 's/extras//' Makefile.in

./configure \
    --prefix=/usr \
    --host=$target \
    --build=$host

make -j${jobs}

make -j${jobs} DESTDIR="${LFS}" install

cleanup() {
    cd -- "$TMPDIR" && rm -rf gawk-$version
}
